\hypertarget{functions_8h}{}\section{functions.\+h File Reference}
\label{functions_8h}\index{functions.\+h@{functions.\+h}}
{\ttfamily \#include $<$deal.\+I\+I/base/exceptions.\+h$>$}\\*
{\ttfamily \#include $<$deal.\+I\+I/lac/vector.\+h$>$}\\*
{\ttfamily \#include $<$gsl/gsl\+\_\+integration.\+h$>$}\\*
{\ttfamily \#include $<$gsl/gsl\+\_\+sf\+\_\+gamma.\+h$>$}\\*
{\ttfamily \#include $<$cmath$>$}\\*
{\ttfamily \#include $<$cstdlib$>$}\\*
{\ttfamily \#include $<$numeric$>$}\\*
{\ttfamily \#include $<$stdexcept$>$}\\*
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include $<$utility$>$}\\*
{\ttfamily \#include $<$vector$>$}\\*
Include dependency graph for functions.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{functions_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=290pt]{functions_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$int dim$>$ }\\Tensor$<$ 4, dim $>$ \hyperlink{functions_8h_a6e649771188b6d625bea6309e77fbd16}{get\+\_\+tensor\+\_\+operator\+\_\+G} (const Symmetric\+Tensor$<$ 2, dim $>$ \&Ma, const Symmetric\+Tensor$<$ 2, dim $>$ \&Mb)
\item 
{\footnotesize template$<$int dim$>$ }\\Tensor$<$ 4, dim $>$ \hyperlink{functions_8h_acfd8da38df3766246f7bcf0e736ad9f4}{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+right} (const Symmetric\+Tensor$<$ 2, dim $>$ \&Ma, const Symmetric\+Tensor$<$ 2, dim $>$ \&Mb, const Symmetric\+Tensor$<$ 2, dim $>$ \&Mc, const Symmetric\+Tensor$<$ 2, dim $>$ \&T)
\item 
{\footnotesize template$<$int dim$>$ }\\Tensor$<$ 4, dim $>$ \hyperlink{functions_8h_a6f9435c7728281851248d3537c100e7d}{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+left} (const Symmetric\+Tensor$<$ 2, dim $>$ \&Ma, const Symmetric\+Tensor$<$ 2, dim $>$ \&Mb, const Symmetric\+Tensor$<$ 2, dim $>$ \&Mc, const Symmetric\+Tensor$<$ 2, dim $>$ \&T)
\item 
{\footnotesize template$<$int dim$>$ }\\bool \hyperlink{functions_8h_aa37f13547b984cb066e2fcb530b36425}{symmetry\+\_\+check} (Tensor$<$ 2, dim $>$ \&tensor)
\item 
{\footnotesize template$<$int dim$>$ }\\bool \hyperlink{functions_8h_adaf42311602a831f5c8c0fffdbb8aa63}{symmetry\+\_\+check} (const Tensor$<$ 4, dim $>$ \&temp)
\item 
{\footnotesize template$<$int dim$>$ }\\Symmetric\+Tensor$<$ 4, dim $>$ \hyperlink{functions_8h_afe83e9509497294b7f662b800b6b91ff}{symmetrize} (const Tensor$<$ 4, dim $>$ \&tensor)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{functions.\+h@{functions.\+h}!get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+left@{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+left}}
\index{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+left@{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+left}!functions.\+h@{functions.\+h}}
\subsubsection[{\texorpdfstring{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+left(const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Ma, const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Mb, const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Mc, const Symmetric\+Tensor$<$ 2, dim $>$ \&\+T)}{get_tensor_operator_F_left(const SymmetricTensor< 2, dim > &Ma, const SymmetricTensor< 2, dim > &Mb, const SymmetricTensor< 2, dim > &Mc, const SymmetricTensor< 2, dim > &T)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$int dim$>$ Tensor$<$4,dim$>$ get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+left (
\begin{DoxyParamCaption}
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Ma, }
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Mb, }
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Mc, }
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{T}
\end{DoxyParamCaption}
)}\hypertarget{functions_8h_a6f9435c7728281851248d3537c100e7d}{}\label{functions_8h_a6f9435c7728281851248d3537c100e7d}


Referenced by ln\+\_\+space\+::post\+\_\+ln(), and Constitutive\+\_\+\+Laws\+::\+Thermo\+\_\+\+Elasto\+\_\+\+Plastic$<$ dim $>$\+::return\+\_\+stress\+\_\+tangent\+\_\+int\+\_\+variables\+\_\+for\+\_\+large\+\_\+strain().


\begin{DoxyCode}
79                                                                          \{
80     Tensor<4,dim> tmp;
81 
82     Tensor<2,dim> temp\_tensor = contract<1,0>((Tensor<2,dim>)T, (Tensor<2,dim>)Mb);
83     Tensor<2,dim> MaTMb = contract<1,0>((Tensor<2,dim>)Ma,temp\_tensor);
84 
85     for(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<dim; ++i)\{
86         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j<dim; ++j)\{
87             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k=0; k<dim; ++k)\{
88                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} l=0; l<dim; ++l)\{
89                     tmp[i][j][k][l] = MaTMb[i][k] * Mc[j][l] + MaTMb[i][l] * Mc[j][k];
90                 \}
91             \}
92         \}
93     \}
94     \textcolor{keywordflow}{return} tmp;
95 \}
\end{DoxyCode}
\index{functions.\+h@{functions.\+h}!get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+right@{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+right}}
\index{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+right@{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+right}!functions.\+h@{functions.\+h}}
\subsubsection[{\texorpdfstring{get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+right(const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Ma, const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Mb, const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Mc, const Symmetric\+Tensor$<$ 2, dim $>$ \&\+T)}{get_tensor_operator_F_right(const SymmetricTensor< 2, dim > &Ma, const SymmetricTensor< 2, dim > &Mb, const SymmetricTensor< 2, dim > &Mc, const SymmetricTensor< 2, dim > &T)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$int dim$>$ Tensor$<$4,dim$>$ get\+\_\+tensor\+\_\+operator\+\_\+\+F\+\_\+right (
\begin{DoxyParamCaption}
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Ma, }
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Mb, }
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Mc, }
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{T}
\end{DoxyParamCaption}
)}\hypertarget{functions_8h_acfd8da38df3766246f7bcf0e736ad9f4}{}\label{functions_8h_acfd8da38df3766246f7bcf0e736ad9f4}


Referenced by ln\+\_\+space\+::post\+\_\+ln(), and Constitutive\+\_\+\+Laws\+::\+Thermo\+\_\+\+Elasto\+\_\+\+Plastic$<$ dim $>$\+::return\+\_\+stress\+\_\+tangent\+\_\+int\+\_\+variables\+\_\+for\+\_\+large\+\_\+strain().


\begin{DoxyCode}
55                                                                           \{
56     Tensor<4,dim> tmp;
57 
58     Tensor<2,dim> temp\_tensor = contract<1,0>((Tensor<2,dim>)T, (Tensor<2,dim>)Mc);
59     Tensor<2,dim> MbTMc = contract<1,0>((Tensor<2,dim>)Mb,temp\_tensor);
60 
61     for(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<dim; ++i)\{
62         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j<dim; ++j)\{
63             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k=0; k<dim; ++k)\{
64                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} l=0; l<dim; ++l)\{
65                     tmp[i][j][k][l] = Ma[i][k] * MbTMc[j][l] + Ma[i][l] * MbTMc[j][k];
66                 \}
67             \}
68         \}
69     \}
70 
71     \textcolor{keywordflow}{return} tmp;
72 \}
\end{DoxyCode}
\index{functions.\+h@{functions.\+h}!get\+\_\+tensor\+\_\+operator\+\_\+G@{get\+\_\+tensor\+\_\+operator\+\_\+G}}
\index{get\+\_\+tensor\+\_\+operator\+\_\+G@{get\+\_\+tensor\+\_\+operator\+\_\+G}!functions.\+h@{functions.\+h}}
\subsubsection[{\texorpdfstring{get\+\_\+tensor\+\_\+operator\+\_\+\+G(const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Ma, const Symmetric\+Tensor$<$ 2, dim $>$ \&\+Mb)}{get_tensor_operator_G(const SymmetricTensor< 2, dim > &Ma, const SymmetricTensor< 2, dim > &Mb)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$int dim$>$ Tensor$<$4,dim$>$ get\+\_\+tensor\+\_\+operator\+\_\+G (
\begin{DoxyParamCaption}
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Ma, }
\item[{const Symmetric\+Tensor$<$ 2, dim $>$ \&}]{Mb}
\end{DoxyParamCaption}
)}\hypertarget{functions_8h_a6e649771188b6d625bea6309e77fbd16}{}\label{functions_8h_a6e649771188b6d625bea6309e77fbd16}


Referenced by ln\+\_\+space\+::post\+\_\+ln(), and Constitutive\+\_\+\+Laws\+::\+Thermo\+\_\+\+Elasto\+\_\+\+Plastic$<$ dim $>$\+::return\+\_\+stress\+\_\+tangent\+\_\+int\+\_\+variables\+\_\+for\+\_\+large\+\_\+strain().


\begin{DoxyCode}
34                                                                                                        \{
35 
36     Tensor<4,dim> tmp;
37 
38     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<dim; ++i)\{
39         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j<dim; ++j)\{
40             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k=0; k<dim; ++k)\{
41                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} l=0; l<dim; ++l)\{
42                     tmp[i][j][k][l] = Ma[i][k] * Mb[j][l] + Ma[i][l] * Mb[j][k];
43                 \}
44             \}
45         \}
46     \}
47     \textcolor{keywordflow}{return} tmp;
48 \}
\end{DoxyCode}
\index{functions.\+h@{functions.\+h}!symmetrize@{symmetrize}}
\index{symmetrize@{symmetrize}!functions.\+h@{functions.\+h}}
\subsubsection[{\texorpdfstring{symmetrize(const Tensor$<$ 4, dim $>$ \&tensor)}{symmetrize(const Tensor< 4, dim > &tensor)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$int dim$>$ Symmetric\+Tensor$<$4,dim$>$ symmetrize (
\begin{DoxyParamCaption}
\item[{const Tensor$<$ 4, dim $>$ \&}]{tensor}
\end{DoxyParamCaption}
)}\hypertarget{functions_8h_afe83e9509497294b7f662b800b6b91ff}{}\label{functions_8h_afe83e9509497294b7f662b800b6b91ff}


References symmetry\+\_\+check().



Referenced by ln\+\_\+space\+::post\+\_\+ln(), ln\+\_\+space\+::pre\+\_\+ln(), and Constitutive\+\_\+\+Laws\+::\+Thermo\+\_\+\+Elasto\+\_\+\+Plastic$<$ dim $>$\+::return\+\_\+stress\+\_\+tangent\+\_\+int\+\_\+variables\+\_\+for\+\_\+large\+\_\+strain().


\begin{DoxyCode}
172                                                               \{
173     SymmetricTensor<4,dim> sym\_tensor;
174     Assert(\hyperlink{functions_8h_aa37f13547b984cb066e2fcb530b36425}{symmetry\_check}(tensor), ExcMessage(\textcolor{stringliteral}{"Tensor to symmetrize is not symmetric!"}));
175 
176     Tensor<4,dim> temp\_tensor;
177     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<dim; ++i)
178         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j<dim; ++j)
179             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k=0; k<dim; ++k)
180                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} l=0; l<dim; ++l)
181                     temp\_tensor[i][j][k][l] = (tensor[i][j][k][l]+tensor[j][i][k][l]+tensor[i][j][l][k]) / 
      3.0;
182 
183     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<dim; ++i)
184         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=i; j<dim; ++j)
185             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k=0; k<dim; ++k)
186                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} l=k; l<dim; ++l)
187                     sym\_tensor[i][j][k][l] = temp\_tensor[i][j][k][l];
188 \textcolor{comment}{//                    sym\_tensor[i][j][k][l] = tensor[i][j][k][l];}
189 
190     \textcolor{keywordflow}{return} sym\_tensor;
191 \}
\end{DoxyCode}
\index{functions.\+h@{functions.\+h}!symmetry\+\_\+check@{symmetry\+\_\+check}}
\index{symmetry\+\_\+check@{symmetry\+\_\+check}!functions.\+h@{functions.\+h}}
\subsubsection[{\texorpdfstring{symmetry\+\_\+check(\+Tensor$<$ 2, dim $>$ \&tensor)}{symmetry_check(Tensor< 2, dim > &tensor)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$int dim$>$ bool symmetry\+\_\+check (
\begin{DoxyParamCaption}
\item[{Tensor$<$ 2, dim $>$ \&}]{tensor}
\end{DoxyParamCaption}
)}\hypertarget{functions_8h_aa37f13547b984cb066e2fcb530b36425}{}\label{functions_8h_aa37f13547b984cb066e2fcb530b36425}


Referenced by ln\+\_\+space\+::post\+\_\+ln(), Constitutive\+\_\+\+Laws\+::\+Thermo\+\_\+\+Elasto\+\_\+\+Plastic$<$ dim $>$\+::return\+\_\+stress\+\_\+tangent\+\_\+int\+\_\+variables\+\_\+for\+\_\+large\+\_\+strain(), and symmetrize().


\begin{DoxyCode}
102 \{
103     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<dim; i++ )
104         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j<dim; j++ )
105             \textcolor{keywordflow}{if} ( i!=j && ( std::abs(tensor[i][j] - tensor[j][i])>1e-12 ) )
106                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
107 
108     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
109 \}
\end{DoxyCode}
\index{functions.\+h@{functions.\+h}!symmetry\+\_\+check@{symmetry\+\_\+check}}
\index{symmetry\+\_\+check@{symmetry\+\_\+check}!functions.\+h@{functions.\+h}}
\subsubsection[{\texorpdfstring{symmetry\+\_\+check(const Tensor$<$ 4, dim $>$ \&temp)}{symmetry_check(const Tensor< 4, dim > &temp)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$int dim$>$ bool symmetry\+\_\+check (
\begin{DoxyParamCaption}
\item[{const Tensor$<$ 4, dim $>$ \&}]{temp}
\end{DoxyParamCaption}
)}\hypertarget{functions_8h_adaf42311602a831f5c8c0fffdbb8aa63}{}\label{functions_8h_adaf42311602a831f5c8c0fffdbb8aa63}

\begin{DoxyCode}
123                                               \{
124     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<dim; ++i)\{
125         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j=0; j<dim; ++j)\{
126             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k=0; k<dim; ++k)\{
127                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} l=0; l<dim; ++l)\{
128                     \textcolor{comment}{// absolute difference check}
129                     \textcolor{keywordflow}{if}(    ( fabs(temp[i][j][k][l] - temp[j][i][k][l]) > 1e-6 )
130                             ||
131                           ( fabs(temp[i][j][k][l] - temp[i][j][l][k]) > 1e-6 ) )
132                     \{
133                         \textcolor{comment}{// relative difference check}
134                         \textcolor{keywordflow}{if}( (fabs(fabs(temp[i][j][k][l] - temp[j][i][k][l])/temp[j][i][k][l])> 1e-8)
135                             ||
136                           (fabs(fabs(temp[i][j][k][l] - temp[i][j][l][k])/temp[i][j][l][k]) >1e-8) )
137                         \{
138                             deallog<< std::endl;
139                             deallog<< \textcolor{stringliteral}{"Abs not matching: "}<<fabs(temp[i][j][k][l] - temp[j][i][k][l])
140                                 << \textcolor{stringliteral}{" | Rel not matching: "}<<fabs(temp[i][j][k][l] - temp[j][i][k][l])/temp[
      j][i][k][l]
141                                 << \textcolor{stringliteral}{" | Abs not matching: "}<<fabs(temp[i][j][k][l] - temp[i][j][l][k])
142                                 << \textcolor{stringliteral}{" | Rel not matching: "}<<fabs(temp[i][j][k][l] - temp[i][j][l][k])/temp[
      i][j][l][k]
143                                 << \textcolor{stringliteral}{" | value ijkl: "}<< std::scientific << temp[i][j][k][l]
144                                 << \textcolor{stringliteral}{" | value jikl: "}<< std::scientific << temp[j][i][k][l]
145                                 << \textcolor{stringliteral}{" | value ijlk: "}<< std::scientific << temp[i][j][l][k]
146                                 << std::endl;
147                             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
148                         \}
149                     \}
150                 \}
151             \}
152         \}
153     \}
154     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
155 \}
\end{DoxyCode}
